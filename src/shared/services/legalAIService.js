import apiService from "./apiService";

export const legalAIService = {
  askQuestion: async (question) => {
    try {
      // Try REST API first (fallback to local response)
      const response = await apiService.post('/legal-ai/ask/', { question });
      console.log('API Response:', response); // Debug log
      
      // apiService already returns response.data, so we access .response directly
      const apiResponse = response?.response || response?.data?.response;
      
      return {
        success: true,
        message: "ุณูุงู ุดูุง ุจุง ููููุช ูพุฑุฏุงุฒุด ุดุฏ",
        legalQuestion: {
          id: Date.now(),
          question: question,
          response: apiResponse || generateLocalResponse(question),
          status: "completed",
          createdAt: new Date().toISOString()
        }
      };
    } catch (error) {
      console.log('REST API failed, using fallback response:', error);
      // Fallback to local response
      return {
        success: true,
        message: "ูพุงุณุฎ ูุญู ุงุฑุงุฆู ุดุฏ",
        legalQuestion: {
          id: Date.now(),
          question: question,
          response: generateLocalResponse(question),
          status: "completed",
          createdAt: new Date().toISOString()
        }
      };
    }
  },

  getLegalQuestions: async () => {
    try {
      const response = await apiService.get('/legal-ai/questions/');
      return response.data;
    } catch (error) {
      console.log('Failed to get legal questions, returning empty array');
      return [];
    }
  },

  getLegalDocuments: async () => {
    try {
      const response = await apiService.get('/legal-ai/documents/');
      return response.data;
    } catch (error) {
      console.log('Failed to get legal documents, returning empty array');
      return [];
    }
  }
};

// Local response generator (same as in LegalAI.jsx)
const generateLocalResponse = (question) => {
  const lowerQuestion = question.toLowerCase();
  
  if (lowerQuestion.includes('ุณูุงู') || lowerQuestion.includes('hi')) {
    return `ุณูุงู! ๐ ุฎูุด ุขูุฏุฏ ุจู ุฏุณุชุงุฑ ุญููู ููฺฉูฺฏ!

ูู ุงูุฌุง ูุณุชู ุชุง ุฏุฑ ูุณุงุฆู ุญููู ูุฑุจูุท ุจู ูุฏุฑุช ุณุงุฎุชูุงู ฺฉูฺฉุชูู ฺฉูู.

**ูโุชููุฏ ุฏุฑ ููุฑุฏ ุงู ููุถูุนุงุช ุงุฒู ุจูพุฑุณุฏ:**
โข ูุฏุฑุช ุณุงุฎุชูุงู ู ููุงูู ูุฑุจูุทู
โข ูุณุงุฆู ูุงู ู ุดุงุฑฺ ุณุงุฎุชูุงู
โข ุญููู ูุงูฺฉุงู ู ุณุงฺฉูุงู
โข ูุฑุงุฑุฏุงุฏูุง ุงุฌุงุฑู
โข ุชุฎูู ููฺฉ ู ูุณุงุฆู ูุงููู

ฺู ุณูุงู ุฏุงุฑุฏุ ๐`;
  }

  if (lowerQuestion.includes('ูุฏุฑุช') || lowerQuestion.includes('ูุฏุฑ')) {
    return `## ูุฏุฑุช ุณุงุฎุชูุงู

**ูุธุงู ูุฏุฑ ุณุงุฎุชูุงู:**
โข ูฺฏูุฏุงุฑ ู ุชุนูุฑุงุช ูุดุชุฑฺฉ
โข ูุฏุฑุช ูุงู ุณุงุฎุชูุงู
โข ุงุฌุฑุง ุขูโูุงูู ุณุงุฎุชูุงู
โข ุงุฑุชุจุงุท ุจุง ูุงูฺฉุงู ู ุณุงฺฉูุงู

**ููุงูู ููู:**
โข ูุงููู ุชููฺฉ ุขูพุงุฑุชูุงูโูุง
โข ุขูโูุงูู ุงุฌุฑุง ูุงููู ุชููฺฉ
โข ููุฑุฑุงุช ุดูุฑุฏุงุฑ

**ูฺฉุงุช ููู:**
ูุฏุฑ ุณุงุฎุชูุงู ุจุงุฏ ฺฏุฒุงุฑุดโูุง ูุงู ูุงูุงูู ุชูู ฺฉูุฏ ู ุฏุฑ ุงุฎุชุงุฑ ูุงูฺฉุงู ูุฑุงุฑ ุฏูุฏ.`;
  }

  if (lowerQuestion.includes('ุดุงุฑฺ') || lowerQuestion.includes('ูุงู') || lowerQuestion.includes('ูพูู')) {
    return `## ูุญุงุณุจู ุดุงุฑฺ ุณุงุฎุชูุงู

**ุดุงุฑฺ ุจุฑ ุงุณุงุณ:**
โข ูุชุฑุงฺ ูุงุญุฏ
โข ูุฒููโูุง ูุดุชุฑฺฉ ุณุงุฎุชูุงู
โข ุชุนูุฑุงุช ู ูฺฏูุฏุงุฑ
โข ุฎุฏูุงุช ุนููู

**ูุฒููโูุง ูุดุชุฑฺฉ ุดุงูู:**
โข ุจุฑู ูุดุชุฑฺฉ (ุฑุงูโูพููุ ูพุงุฑฺฉูฺฏุ ุขุณุงูุณูุฑ)
โข ุขุจ ู ฺฏุงุฒ ูุดุชุฑฺฉ
โข ุชุนูุฑุงุช ุนููู
โข ุจูู ุณุงุฎุชูุงู
โข ูุธุงูุช ู ูฺฏูุจุงู

**ูุญูู ูุญุงุณุจู:**
ุดุงุฑฺ ูุฑ ูุงุญุฏ = (ูุชุฑุงฺ ูุงุญุฏ รท ูุฌููุน ูุชุฑุงฺ ฺฉู ุณุงุฎุชูุงู) ร ูุฌููุน ูุฒููโูุง ูุดุชุฑฺฉ

**ูุซุงู:** ุงฺฏุฑ ุณุงุฎุชูุงู 1000 ูุชุฑ ูุฑุจุน ุจุงุดุฏ ู ูุงุญุฏ ุดูุง 100 ูุชุฑ ูุฑุจุนุ ุดูุง 10% ุงุฒ ูุฒููโูุง ูุดุชุฑฺฉ ุฑุง ูพุฑุฏุงุฎุช ูโฺฉูุฏ.`;
  }

  if (lowerQuestion.includes('ูุฏู') || lowerQuestion.includes('ููุด ูุตููุน') || lowerQuestion.includes('ai')) {
    return `## ุฏุฑุจุงุฑู ูู

ูู ฺฉ ุฏุณุชุงุฑ ุญููู ููุดููุฏ ูุณุชู ฺฉู ุจุฑุง ฺฉูฺฉ ุจู ูุณุงุฆู ุญููู ูุฑุจูุท ุจู ูุฏุฑุช ุณุงุฎุชูุงู ุทุฑุงุญ ุดุฏูโุงู.

**ูุงุจูุชโูุง ูู:**
โข ูพุงุณุฎฺฏู ุจู ุณูุงูุงุช ุญููู ุณุงุฎุชูุงู
โข ุฑุงูููุง ุฏุฑ ููุฑุฏ ููุงูู ูุฏุฑุช ุณุงุฎุชูุงู
โข ฺฉูฺฉ ุฏุฑ ูุณุงุฆู ูุงู ู ุดุงุฑฺ
โข ุฑุงูููุง ุฏุฑ ููุฑุฏ ูุฑุงุฑุฏุงุฏูุง ุงุฌุงุฑู
โข ูุดุงูุฑู ุฏุฑ ููุฑุฏ ุชุฎูู ููฺฉ

**ูฺฉุชู ููู:**
ูู ฺฉ ุงุจุฒุงุฑ ฺฉูฺฉ ูุณุชู ู ูพุงุณุฎโูุงู ูุจุงุฏ ุจู ุนููุงู ูุดุงูุฑู ุญููู ุฑุณู ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุดูุฏ. ุจุฑุง ูุณุงุฆู ูพฺุฏูุ ุญุชูุงู ุจุง ูฺฉู ูุดูุฑุช ฺฉูุฏ.`;
  }

  return `ูุชุฃุณูุงูู ุฏุฑ ุญุงู ุญุงุถุฑ ูุงุฏุฑ ุจู ูพุงุณุฎฺฏู ูุณุชู. ูุทูุงู ุณูุงู ุฎูุฏ ุฑุง ุจุง ุฌุฒุฆุงุช ุจุดุชุฑ ูุทุฑุญ ฺฉูุฏ ุง ุงุฒ ุณูุงูุงุช ูพุดููุงุฏ ุงุณุชูุงุฏู ฺฉูุฏ.

**ุจุฑุง ฺฉูฺฉ ุจูุชุฑุ ูุทูุงู:**
โข ุณูุงู ุฑู ูุงุถุญโุชุฑ ุจูพุฑุณุฏ
โข ุงุฒ ฺฉููุงุช ฺฉูุฏ ุงุณุชูุงุฏู ฺฉูุฏ ูุซู:
  - ูุฏุฑุช ุณุงุฎุชูุงู
  - ูุณุงุฆู ูุงู
  - ุญููู ูุงูฺฉุงู
  - ุงุฌุงุฑู ุณุงุฎุชูุงู
  - ุดุงุฑฺ ุณุงุฎุชูุงู
  - ุชุฎูู ููฺฉ
  - ูุฑุงุฑุฏุงุฏ ุงุฌุงุฑู

**ุง ูโุชููุฏ ุจูพุฑุณุฏ:**
โข "ุณูุงู" ุจุฑุง ุดุฑูุน
โข "ูุฏุฑุช ุณุงุฎุชูุงู ฺูุ"
โข "ุดุงุฑฺ ุณุงุฎุชูุงู ฺุทูุฑ ูุญุงุณุจู ูุดูุ"
โข "ูุณุชุงุฌุฑู ูพูู ููุฏู ฺฺฉุงุฑ ฺฉููุ"

ูู ุงูุฌุง ูุณุชู ุชุง ฺฉูฺฉุชูู ฺฉูู! ๐`;
};
